-- MySQL Script generated by MySQL Workbench
-- Thu Jul  2 22:29:22 2020
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema IS_Meteoroloske_stanice
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema IS_Meteoroloske_stanice
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `IS_Meteoroloske_stanice` DEFAULT CHARACTER SET utf8 ;
USE `IS_Meteoroloske_stanice` ;

-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`WMO_standard`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`WMO_standard` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`WMO_standard` (
  `rbr` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `opis` VARCHAR(400) NOT NULL,
  `dat_stup_na_snagu` DATE NOT NULL,
  PRIMARY KEY (`rbr`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`grad`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`grad` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`grad` (
  `ptt` INT UNSIGNED NOT NULL,
  `naziv` VARCHAR(25) NOT NULL,
  PRIMARY KEY (`ptt`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`statistika`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`statistika` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`statistika` (
  `ID_stat` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `dat_stat` DATE NOT NULL,
  PRIMARY KEY (`ID_stat`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`stanica`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`stanica` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`stanica` (
  `ID_stanice` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naz_stan` VARCHAR(25) NOT NULL,
  `geo_šir` DECIMAL(5,3) UNSIGNED NOT NULL,
  `geo_duž` DECIMAL(5,3) UNSIGNED NOT NULL,
  `nadm_vis` INT UNSIGNED NOT NULL,
  `ptt` INT UNSIGNED NOT NULL,
  `ID_stat` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_stanice`),
  INDEX `fk_stanica_grad1_idx` (`ptt` ASC) VISIBLE,
  INDEX `fk_stanica_statistika1_idx` (`ID_stat` ASC) VISIBLE,
  CONSTRAINT `fk_stanica_grad1`
    FOREIGN KEY (`ptt`)
    REFERENCES `IS_Meteoroloske_stanice`.`grad` (`ptt`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_stanica_statistika1`
    FOREIGN KEY (`ID_stat`)
    REFERENCES `IS_Meteoroloske_stanice`.`statistika` (`ID_stat`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`poštuje`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`poštuje` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`poštuje` (
  `ID_stanice` INT UNSIGNED NOT NULL,
  `rbr` INT UNSIGNED NOT NULL,
  INDEX `fk_poštuje_stanica_idx` (`ID_stanice` ASC) VISIBLE,
  INDEX `fk_poštuje_WMO_standard_idx` (`rbr` ASC) VISIBLE,
  PRIMARY KEY (`ID_stanice`, `rbr`),
  CONSTRAINT `fk_poštuje_stanica`
    FOREIGN KEY (`ID_stanice`)
    REFERENCES `IS_Meteoroloske_stanice`.`stanica` (`ID_stanice`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE,
  CONSTRAINT `fk_poštuje_WMO_standard`
    FOREIGN KEY (`rbr`)
    REFERENCES `IS_Meteoroloske_stanice`.`WMO_standard` (`rbr`)
    ON DELETE RESTRICT
    ON UPDATE CASCADE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`osmatrač`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`osmatrač` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`osmatrač` (
  `ID_osmatrača` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `ime` VARCHAR(15) NOT NULL,
  `prezime` VARCHAR(15) NOT NULL,
  `jmbg` INT UNSIGNED NOT NULL,
  `dat_zap` DATE NOT NULL,
  `ptt` INT UNSIGNED NOT NULL,
  `ID_stanice` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_osmatrača`),
  UNIQUE INDEX `jmbg_UNIQUE` (`jmbg` ASC) VISIBLE,
  INDEX `fk_osmatrač_grad1_idx` (`ptt` ASC) VISIBLE,
  INDEX `fk_osmatrač_stanica1_idx` (`ID_stanice` ASC) VISIBLE,
  CONSTRAINT `fk_osmatrač_grad1`
    FOREIGN KEY (`ptt`)
    REFERENCES `IS_Meteoroloske_stanice`.`grad` (`ptt`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_osmatrač_stanica1`
    FOREIGN KEY (`ID_stanice`)
    REFERENCES `IS_Meteoroloske_stanice`.`stanica` (`ID_stanice`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`merenje`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`merenje` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`merenje` (
  `ID_merenja` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `dat_mer` DATE NOT NULL,
  `vis_snež_pok` DECIMAL(5,2) UNSIGNED NOT NULL,
  `kol_pad` DECIMAL(5,2) UNSIGNED NOT NULL,
  `vrsta_pad` VARCHAR(15) NOT NULL,
  `ID_stat` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_merenja`),
  INDEX `fk_merenje_statistika1_idx` (`ID_stat` ASC) VISIBLE,
  CONSTRAINT `fk_merenje_statistika1`
    FOREIGN KEY (`ID_stat`)
    REFERENCES `IS_Meteoroloske_stanice`.`statistika` (`ID_stat`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`vrši`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`vrši` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`vrši` (
  `ID_osmatrača` INT UNSIGNED NOT NULL,
  `ID_merenja` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_osmatrača`, `ID_merenja`),
  INDEX `fk_vrši_merenje1_idx` (`ID_merenja` ASC) VISIBLE,
  CONSTRAINT `fk_vrši_osmatrač1`
    FOREIGN KEY (`ID_osmatrača`)
    REFERENCES `IS_Meteoroloske_stanice`.`osmatrač` (`ID_osmatrača`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_vrši_merenje1`
    FOREIGN KEY (`ID_merenja`)
    REFERENCES `IS_Meteoroloske_stanice`.`merenje` (`ID_merenja`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`instrument`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`instrument` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`instrument` (
  `ID_instrumenta` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `naziv` VARCHAR(25) NOT NULL,
  `jedinica` VARCHAR(10) NOT NULL,
  PRIMARY KEY (`ID_instrumenta`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`glavni_prog`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`glavni_prog` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`glavni_prog` (
  `vazd_prit` DECIMAL(5,2) UNSIGNED NOT NULL,
  `vlaž_zem` DECIMAL(5,2) UNSIGNED NOT NULL,
  `insolacija` DECIMAL(5,2) UNSIGNED NOT NULL,
  `isparavanje` DECIMAL(5,2) UNSIGNED NOT NULL,
  `gus_snež_pok` DECIMAL(5,2) UNSIGNED NOT NULL,
  `temp_zem` DECIMAL(4,2) NOT NULL,
  `temp_vazd` INT NOT NULL,
  `vlaž_vazd` DECIMAL(5,2) UNSIGNED NOT NULL,
  `prav_brz_vet` VARCHAR(15) NOT NULL,
  `ID_merenja` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_merenja`),
  CONSTRAINT `fk_glavni_prog_merenje1`
    FOREIGN KEY (`ID_merenja`)
    REFERENCES `IS_Meteoroloske_stanice`.`merenje` (`ID_merenja`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`obični_prog`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`obični_prog` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`obični_prog` (
  `temp_zem` DECIMAL(4,2) NOT NULL,
  `temp_vazd` INT NOT NULL,
  `vlaž_vazd` DECIMAL(5,2) UNSIGNED NOT NULL,
  `prav_brz_vet` VARCHAR(15) NOT NULL,
  `ID_merenja` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID_merenja`),
  CONSTRAINT `fk_obični_prog_merenje1`
    FOREIGN KEY (`ID_merenja`)
    REFERENCES `IS_Meteoroloske_stanice`.`merenje` (`ID_merenja`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `IS_Meteoroloske_stanice`.`koristi`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `IS_Meteoroloske_stanice`.`koristi` ;

CREATE TABLE IF NOT EXISTS `IS_Meteoroloske_stanice`.`koristi` (
  `vrši_ID_osmatrača` INT UNSIGNED NOT NULL,
  `vrši_ID_merenja` INT UNSIGNED NOT NULL,
  `ID_instrumenta` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`vrši_ID_osmatrača`, `vrši_ID_merenja`, `ID_instrumenta`),
  INDEX `fk_koristi_instrument1_idx` (`ID_instrumenta` ASC) VISIBLE,
  CONSTRAINT `fk_koristi_vrši1`
    FOREIGN KEY (`vrši_ID_osmatrača` , `vrši_ID_merenja`)
    REFERENCES `IS_Meteoroloske_stanice`.`vrši` (`ID_osmatrača` , `ID_merenja`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_koristi_instrument1`
    FOREIGN KEY (`ID_instrumenta`)
    REFERENCES `IS_Meteoroloske_stanice`.`instrument` (`ID_instrumenta`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;


INSERT INTO WMO_standard VALUES 
(1, "Položaj stanice koji najbolje reprezentuje vreme i klimu što šire okoline.", '1950-04-20'),
(2, "Oko stanice mora biti otvoren prostor, kako bi vazduh slobodno strujao.", '1952-07-02'),
(3, "Zemljište na kojem se nalazi stanica mora da odgovara prirodnim uslovima dotičnog kraja.", '1954-11-26'),
(4, "Teren na kojem se nalazi stanica ne sme biti nagnut ili na grebenu.", '1957-02-09');

INSERT INTO grad VALUES
(11000, "Beograd"),
(35230, "Ćuprija"),
(22320, "Indjija"),
(34000, "Kragujevac");

INSERT INTO statistika VALUES
(1, '2020-07-01'),
(2, '2020-07-02'),
(3, '2020-07-03'),
(4, '2020-07-04'),
(5, '2020-07-05');

INSERT INTO stanica VALUES
(1, 'METEOS', 44.60, 20.14, 202, 11000, 1),
(2, 'RHMZ Srbije', 43.40, 21.12, 404, 35230, 2),
(3, 'Srba', 44.38, 19.34, 152, 22320, 3),
(4, 'RHMZ Srbije', 44.51, 20.52, 185, 34000, 4);

INSERT INTO osmatrač VALUES
(1, "Milan", "Marković", 0406984710, '2018-05-08', 11000, 1),
(2, "Miloš", "Antić", 0112986710, '2019-03-01', 35230, 2),
(3, "Zlatan", "Spasić", 1706993710, '2017-03-06', 22320, 3),
(4, "Petar", "Jovanović", 1606992710, '2018-02-07', 34000, 4);

INSERT INTO merenje VALUES
(1, '2020-07-01', 0, 3.2, "Kiša" ,1),
(2, '2020-07-02' , 0, 4.3, "Kiša" ,2),
(3, '2020-07-03' , 0, 0, "Nema padavina" ,3),
(4, '2020-07-04' , 0, 8.4, "Kiša i grad" ,4);

INSERT INTO instrument VALUES
(1, "Termometar" ,"°C"),
(2, "higrometar" ,"%"),
(3, "Barometar" ,"hPa"),
(4, "Kišomer" ,"mm/h"),
(5, "Anemometar" ,"km/h");

INSERT INTO glavni_prog VALUES
(4.2, 1.6, 23.5, 11.2, 0, 3.7, 1, 1.21, "N999", 1),
(5.2, 5.6, 1.5, 4.2, 0, 4.7, 5, 3.21, "W575", 2);

INSERT INTO obični_prog VALUES
(14.6, 3, 1.3, "E444", 3);